(function(){"use strict";var t={3427:function(t,e,n){var s=n(6848),r=function(){var t=this,e=t._self._c;return e("div",[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".svg"},on:{change:t.handleFileUpload}}),e("div",{staticClass:"topBUt"},[e("button",{on:{click:t.triggerFileUpload}},[t._v("导入SVG文件")]),e("button",{on:{click:function(e){return t.copeSvg()}}},[t._v("导出修改后的svg")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Svgname,expression:"Svgname"}],staticStyle:{width:"20vw","margin-right":"4vw"},attrs:{type:"text",placeholder:"默认保存名"},domProps:{value:t.Svgname},on:{input:function(e){e.target.composing||(t.Svgname=e.target.value)}}}),e("button",{staticClass:"basicsXiu",on:{click:function(e){return t.basics()}}},[t._v("基础修改")]),t._l(t.colew,(function(n,s){return e("div",{key:s,staticClass:"div12",style:"background-color:"+n,on:{click:function(e){return t.cclier(n)}}},[t._v(" "+t._s(t.colorClass[n].slice(2,-2))+" ")])})),e("span",[t._v("线条颜色：")]),t._l(t.clomne,(function(n){return e("div",{key:n,staticClass:"div12",style:"background-color:"+n,on:{click:function(e){return t.cclier(n)}}})})),e("svg",{staticStyle:{width:"8vh",height:"8vh"},attrs:{xmlns:"http://www.w3.org/2000/svg"}},[e("g",{attrs:{id:"sanId"},domProps:{innerHTML:t._s(t.sanseSvg)}})])],2),e("div",{attrs:{id:"svg-dialog__body"}},[e("div",{ref:"svgContainer",staticClass:"boxpo",staticStyle:{position:"relative"},on:{mousedown:t.startSelection,mouseup:t.updateSelection}},[t.selecFrame.isSelecting?e("div",{staticClass:"selection-box",style:t.selecFrame.selectionStyle}):t._e(),t.svgContent?e("div",{attrs:{id:"svg-trigger"},domProps:{innerHTML:t._s(t.newSvgContent)}}):t._e()])])])},i=[],o=(n(4114),n(4603),n(7566),n(8721),{data(){return{svgContent:null,newSvgContent:null,Svgname:"",svgContentSrc:null,embedLoading:!1,SVGTitle:"",currentSvg:null,oldTargetNode:[],jumpSVGData:{},startX:0,startY:0,endX:0,endY:0,selectedLines:[],threeModel:[],colew:["rgb(240,65,85)","rgb(128,0,128)","rgb(255,255,0)","rgb(128,128,128)","rgb(0,0,139)","rgb(185,72,66)"],clomne:["rgb(0,0,255)","rgb(128,128,128)","rgb(0,255,255)"],newSelectedLines:[],newSelectedModel:[],selecFrame:{isSelecting:!1,selectionStyle:{position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",backgroundColor:"rgba(255, 0, 0, 0.3)",border:"1px solid red"}},colorClass:{"rgb(240,65,85)":"kv110kV","rgb(128,0,128)":"kv220kV","rgb(255,255,0)":"kv35kV","rgb(128,128,128)":"kv0kV","rgb(0,0,139)":"kv6kV","rgb(185,72,66)":"kv10kV"},svgDoc:"",sanseSvg:"",sanseColor:""}},methods:{startSelection(t){this.startX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.startY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top,console.log("按下坐标：",this.startX,this.startY),this.selecFrame.isSelecting=!0,window.addEventListener("mousemove",this.updateSelecmove)},updateSelecmove(t){this.endX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.endY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top;const e=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),s=(Math.max(this.startX,this.endX),Math.max(this.startY,this.endY),Math.abs(this.endX-this.startX)),r=Math.abs(this.endY-this.startY);this.selecFrame.selectionStyle.left=e+"px",this.selecFrame.selectionStyle.top=n+"px",this.selecFrame.selectionStyle.width=s+"px",this.selecFrame.selectionStyle.height=r+"px"},updateSelection(t){const e=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),s=Math.max(this.startX,this.endX),r=Math.max(this.startY,this.endY);this.newSelectedLines=this.getIntersectingLines(e,n,s,r),this.newSelectedModel=this.getIntersectingmodel(e,n,s,r),console.log("选中的内容",this.newSelectedLines,this.newSelectedModel),window.removeEventListener("mousemove",this.updateSelecmove)},getIntersectingLines(t,e,n,s){console.log("选中的线条",t,e,n,s);const r=[],i=this.svgDoc.querySelectorAll("path");function o(r,i){return r>=t&&r<=n&&i>=e&&i<=s}function l(t){const e=t.match(/[ML]/g),n=t.match(/-?\d+(?:\.\d+)?/g).map(Number),s={};let r=0,i=0;for(let o=0;o<e.length;o++){const t=e[o];let l,c;"M"===t?((0===o||n[2*o-2]!==r&&n[2*o-1]!==i)&&(s["startX"]=n[2*o],s["startY"]=n[2*o+1]),r=n[2*o],i=n[2*o+1]):"L"===t&&(l=n[2*o]+("l"===t?r:0),c=n[2*o+1]+("l"===t?i:0),s["endX"]=l,s["endY"]=c,r=l,i=c)}return s}function c(t){const e=t.getAttribute("d"),n=l(e);return!(!o(n.startX,n.startY)&&!o(n.endX,n.endY))}for(const a of i)c(a)&&r.push(a);return r},getIntersectingmodel(t,e,n,s){const r=[],i=this.svgDoc.querySelectorAll("use");function o(r,i){return r>=t&&r<=n&&i>=e&&i<=s}function l(t){const e=t.getAttribute("x"),n=t.getAttribute("y"),s=e+t.getAttribute("width"),r=n+t.getAttribute("height");return!(!o(e,n)&&!o(s,r))}for(const c of i)l(c)&&r.push(c);return r},cclier(t){if(console.log("选中颜色",t,this.sanseColor),this.sanseColor){console.log("11112",this.colorClass[t]),this.threeModel.forEach((e=>{var n=e.getAttributeNS("http://www.w3.org/1999/xlink","href");n&&n.startsWith(this.sanseColor)&&(console.log("发广告广告",e),e.setAttribute("class",this.colorClass[t]))})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc);let e=document.getElementById("sanId");const n=e.querySelectorAll("use");return n.forEach((e=>{var n=e.getAttributeNS("http://www.w3.org/1999/xlink","href");n&&n.startsWith(this.sanseColor)&&e.setAttribute("class",this.colorClass[t])})),void(this.sanseColor="")}this.newSelectedLines.forEach((e=>{e.setAttribute("stroke",t)})),this.newSelectedModel.forEach((e=>{e.setAttribute("class",this.colorClass[t])})),this.selecFrame=this.$options.data().selecFrame,this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc),this.newSelectedLines=[],this.newSelectedModel=[]},basics(){const t=["国网冀北秦皇岛集控站设备监视系统","变电站主页","光字牌索引图","二次网络结构","交直流系统","故障录波","事件列表","智能联动","在线监视","照明控制","动环监控","安全防卫","消防监视","区域用电负荷","实际有功总加"],e=this.svgDoc.querySelectorAll("#Text_Layer>text");t.forEach((t=>{e.forEach((e=>{t!==e.textContent.trim()||e.parentNode.removeChild(e)}))}));const n=this.svgDoc.querySelectorAll("#Other_Layer>image");n.forEach((t=>{t.parentNode.removeChild(t)}));const s=this.svgDoc.querySelectorAll("#Head_Layer>rect");s.forEach((function(t){t.setAttribute("fill","rgb(0,47,71)")}));const r=this.svgDoc.querySelectorAll("#Link_Layer>g>path");r.forEach((t=>{const e=t.getAttribute("d"),n=e.split(" ");n.length>=9&&(t.style["fill"]="none")}));const i=this.svgDoc.querySelectorAll("defs>symbol>*");i.forEach((t=>{t.setAttribute("stroke","")})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc)},triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(t){const e=t.target.files[0];if(e&&"image/svg+xml"===e.type){const t=new FileReader;this.Svgname=this.repName(e.name),t.onload=t=>{this.svgContent=t.target.result,this.newSvgContent=t.target.result,this.svgContentSrc=URL.createObjectURL(e),this.$nextTick((()=>{const t=new DOMParser;this.svgDoc=t.parseFromString(this.newSvgContent,"image/svg+xml");const e=this.svgDoc.querySelectorAll("a");e.forEach((t=>{t.removeAttribute("xlink:href")}));const n=this.svgDoc.querySelectorAll("use"),s=[];if(n.forEach((function(t){var e=t.getAttributeNS("http://www.w3.org/1999/xlink","href");e&&e.startsWith("#Transformer3:")&&(console.log(t.href.animVal),s.push(t))})),this.threeModel=s,this.threeModel.length){const t=this.threeModel[0].parentElement,e=t?t.parentElement:null;console.log("获取三色组件：",e);var r=e.cloneNode(!0);const n=r.querySelectorAll("use");n.forEach((t=>{t.setAttribute("y","50"),t.setAttribute("x","50"),t.setAttribute("style","pointer-events: bounding-box;"),t.setAttribute("transform","rotate(0,770,808) scale(1,1) translate(-50,-48)")})),this.sanseSvg=(new XMLSerializer).serializeToString(r);var i=document.getElementById("sanId"),o=this;i.addEventListener("click",(function(t){console.log("Circle clicked!",t.target.href.animVal),o.sanseColor=t.target.href.animVal}))}}))},t.readAsText(e)}else alert("请选择一个有效的SVG文件")},repName(t){const e=t.replace(/^CD\./,"").replace(/\.fac\.svg$/,""),n=`${e.replace(/_/g,".")}.svg`;return n},copeSvg(){if(!this.newSvgContent)return void alert("请先导入svg文件");const t=new Blob([this.newSvgContent],{type:"image/svg+xml;charset=utf-8"}),e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=this.repName(this.Svgname),document.body.appendChild(n),n.click(),URL.revokeObjectURL(e),document.body.removeChild(n)}}}),l=o,c=n(1656),a=(0,c.A)(l,r,i,!1,null,null,null),h=a.exports;s.Ay.config.productionTip=!1,new s.Ay({render:t=>t(h)}).$mount("#app")}},e={};function n(s){var r=e[s];if(void 0!==r)return r.exports;var i=e[s]={exports:{}};return t[s].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,s,r,i){if(!s){var o=1/0;for(h=0;h<t.length;h++){s=t[h][0],r=t[h][1],i=t[h][2];for(var l=!0,c=0;c<s.length;c++)(!1&i||o>=i)&&Object.keys(n.O).every((function(t){return n.O[t](s[c])}))?s.splice(c--,1):(l=!1,i<o&&(o=i));if(l){t.splice(h--,1);var a=r();void 0!==a&&(e=a)}}return e}i=i||0;for(var h=t.length;h>0&&t[h-1][2]>i;h--)t[h]=t[h-1];t[h]=[s,r,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,s){var r,i,o=s[0],l=s[1],c=s[2],a=0;if(o.some((function(e){return 0!==t[e]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(c)var h=c(n)}for(e&&e(s);a<o.length;a++)i=o[a],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(h)},s=self["webpackChunksvg"]=self["webpackChunksvg"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(3427)}));s=n.O(s)})();