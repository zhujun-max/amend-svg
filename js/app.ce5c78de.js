(function(){"use strict";var t={6201:function(t,e,s){var n=s(6848),r=function(){var t=this,e=t._self._c;return e("div",[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".svg"},on:{change:t.handleFileUpload}}),e("div",{staticClass:"topBUt"},[e("button",{on:{click:t.triggerFileUpload}},[t._v("导入SVG文件")]),e("button",{on:{click:function(e){return t.copeSvg()}}},[t._v("导出修改后的svg")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Svgname,expression:"Svgname"}],staticStyle:{width:"20vw","margin-right":"4vw"},attrs:{type:"text",placeholder:"默认保存名"},domProps:{value:t.Svgname},on:{input:function(e){e.target.composing||(t.Svgname=e.target.value)}}}),e("button",{staticClass:"basicsXiu",on:{click:function(e){return t.basics()}}},[t._v("基础修改")]),t._l(t.colew,(function(s,n){return e("div",{key:n,staticClass:"div12",style:"background-color:"+s,on:{click:function(e){return t.cclier(s)}}},[t._v(" "+t._s(t.colorClass[s].slice(2,-2))+" ")])})),e("span",[t._v("线条颜色：")]),t._l(t.clomne,(function(s){return e("div",{key:s,staticClass:"div12",style:"background-color:"+s,on:{click:function(e){return t.cclier(s)}}})})),e("div",{staticStyle:{width:"5vh",height:"5vh"}},[e("svg",{staticStyle:{width:"100%",height:"100%"},attrs:{viewBox:"0 0 100 100",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("defs",{attrs:{id:"sanIdsan"},domProps:{innerHTML:t._s(t.sanseSvgSan)}}),e("g",{attrs:{id:"sanId"},domProps:{innerHTML:t._s(t.sanseSvg)}})])])],2),e("div",{attrs:{id:"svg-dialog__body"}},[e("div",{ref:"svgContainer",staticClass:"boxpo",staticStyle:{position:"relative"},on:{mousedown:t.startSelection,mouseup:t.updateSelection}},[t.selecFrame.isSelecting?e("div",{staticClass:"selection-box",style:t.selecFrame.selectionStyle},[e("div",{staticClass:"topPO"},[t._v(" "+t._s(Math.trunc(t.selecFrame.selectionStyle.left.split("px")[0]))+"x"+t._s(Math.trunc(t.selecFrame.selectionStyle.top.split("px")[0]))+" ")]),e("div",{staticClass:"bottPO"},[t._v(" "+t._s(Math.trunc(+t.selecFrame.selectionStyle.left.split("px")[0]+ +t.selecFrame.selectionStyle.width.split("px")[0]))+"x"+t._s(Math.trunc(+t.selecFrame.selectionStyle.top.split("px")[0]+ +t.selecFrame.selectionStyle.height.split("px")[0]))+" ")])]):t._e(),t.svgContent?e("div",{attrs:{id:"svg-trigger"},domProps:{innerHTML:t._s(t.newSvgContent)}}):t._e()])])])},i=[],o=(s(4114),s(4603),s(7566),s(8721),{data(){return{svgContent:null,newSvgContent:null,Svgname:"",svgContentSrc:null,embedLoading:!1,SVGTitle:"",currentSvg:null,oldTargetNode:[],jumpSVGData:{},startX:0,startY:0,endX:0,endY:0,selectedLines:[],threeModel:[],colew:["rgb(240,65,85)","rgb(128,0,128)","rgb(255,255,0)","rgb(128,128,128)","rgb(0,0,139)","rgb(185,72,66)"],clomne:["rgb(0,0,255)","rgb(128,128,128)","rgb(0,255,255)"],newSelectedLines:[],newSelectedModel:[],selecFrame:{isSelecting:!1,selectionStyle:{position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",backgroundColor:"rgba(255, 0, 0, 0.3)",border:"1px solid red"}},colorClass:{"rgb(240,65,85)":"kv110kV","rgb(128,0,128)":"kv220kV","rgb(255,255,0)":"kv35kV","rgb(128,128,128)":"kv0kV","rgb(0,0,139)":"kv6kV","rgb(185,72,66)":"kv10kV"},svgDoc:"",sanseSvg:"",sanseColor:"",sanseSvgSan:""}},methods:{startSelection(t){this.startX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.startY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top,console.log("按下坐标：",this.startX,this.startY),this.selecFrame.isSelecting=!0,window.addEventListener("mousemove",this.updateSelecmove)},updateSelecmove(t){this.endX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.endY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top;const e=Math.min(this.startX,this.endX),s=Math.min(this.startY,this.endY),n=(Math.max(this.startX,this.endX),Math.max(this.startY,this.endY),Math.abs(this.endX-this.startX)),r=Math.abs(this.endY-this.startY);this.selecFrame.selectionStyle.left=e+"px",this.selecFrame.selectionStyle.top=s+"px",this.selecFrame.selectionStyle.width=n+"px",this.selecFrame.selectionStyle.height=r+"px"},updateSelection(t){const e=Math.min(this.startX,this.endX),s=Math.min(this.startY,this.endY),n=Math.max(this.startX,this.endX),r=Math.max(this.startY,this.endY);this.newSelectedLines=this.getIntersectingLines(e,s,n,r),this.newSelectedModel=this.getIntersectingmodel(e,s,n,r),console.log("选中的内容",this.newSelectedLines,this.newSelectedModel),window.removeEventListener("mousemove",this.updateSelecmove)},getIntersectingLines(t,e,s,n){console.log("选中的线条",t,e,s,n);const r=[],i=this.svgDoc.querySelectorAll("path");function o(r,i){return r>=t&&r<=s&&i>=e&&i<=n}function l(t){const e=t.match(/[ML]/g),s=t.match(/-?\d+(?:\.\d+)?/g).map(Number),n={};let r=0,i=0;for(let o=0;o<e.length;o++){const t=e[o];let l,c;"M"===t?((0===o||s[2*o-2]!==r&&s[2*o-1]!==i)&&(n["startX"]=s[2*o],n["startY"]=s[2*o+1]),r=s[2*o],i=s[2*o+1]):"L"===t&&(l=s[2*o]+("l"===t?r:0),c=s[2*o+1]+("l"===t?i:0),n["endX"]=l,n["endY"]=c,r=l,i=c)}return n}function c(t){const e=t.getAttribute("d"),s=l(e);return!(!o(s.startX,s.startY)&&!o(s.endX,s.endY))}for(const a of i)c(a)&&r.push(a);return r},getIntersectingmodel(t,e,s,n){const r=[],i=this.svgDoc.querySelectorAll("use");function o(r,i){return r>=t&&r<=s&&i>=e&&i<=n}function l(t){const e=t.getAttribute("x"),s=t.getAttribute("y"),n=e+t.getAttribute("width"),r=s+t.getAttribute("height");return!(!o(e,s)&&!o(n,r))}for(const c of i)l(c)&&r.push(c);return r},cclier(t){if(console.log("选中颜色",t,this.sanseColor),this.sanseColor){console.log("11112",this.colorClass[t]),this.threeModel.forEach((e=>{var s=e.getAttributeNS("http://www.w3.org/1999/xlink","href");s&&s.startsWith(this.sanseColor)&&(console.log("发广告广告",e),e.setAttribute("class",this.colorClass[t]))})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc);let e=document.getElementById("sanId");const s=e.querySelectorAll("use");return s.forEach((e=>{var s=e.getAttributeNS("http://www.w3.org/1999/xlink","href");s&&s.startsWith(this.sanseColor)&&e.setAttribute("class",this.colorClass[t])})),void(this.sanseColor="")}this.newSelectedLines.forEach((e=>{e.setAttribute("stroke",t)})),this.newSelectedModel.forEach((e=>{e.setAttribute("class",this.colorClass[t])})),this.selecFrame=this.$options.data().selecFrame,this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc),this.newSelectedLines=[],this.newSelectedModel=[]},basics(){const t=["国网冀北秦皇岛集控站设备监视系统","变电站主页","光字牌索引图","二次网络结构","交直流系统","故障录波","事件列表","智能联动","在线监视","照明控制","动环监控","安全防卫","消防监视","区域用电负荷","实际有功总加"],e=this.svgDoc.querySelectorAll("#Text_Layer>text");t.forEach((t=>{e.forEach((e=>{t!==e.textContent.trim()||e.parentNode.removeChild(e)}))}));const s=this.svgDoc.querySelectorAll("#Other_Layer>image");s.forEach((t=>{t.parentNode.removeChild(t)}));const n=this.svgDoc.querySelectorAll("#Head_Layer>rect");n.forEach((function(t){t.setAttribute("fill","rgb(0,47,71)")}));const r=this.svgDoc.querySelectorAll("#Link_Layer>g>path");r.forEach((t=>{const e=t.getAttribute("d"),s=e.split(" ");s.length>=9&&(t.style["fill"]="none")}));const i=this.svgDoc.querySelectorAll("defs>symbol>*");i.forEach((t=>{t.setAttribute("stroke","")})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc)},triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(t){const e=t.target.files[0];if(e&&"image/svg+xml"===e.type){const t=new FileReader;this.Svgname=this.repName(e.name),t.onload=t=>{this.svgContent=t.target.result,this.newSvgContent=t.target.result,this.svgContentSrc=URL.createObjectURL(e),this.$nextTick((()=>{const t=new DOMParser;this.svgDoc=t.parseFromString(this.newSvgContent,"image/svg+xml");const e=this.svgDoc.querySelectorAll("a");e.forEach((t=>{t.removeAttribute("xlink:href")}));const s=this.svgDoc.querySelectorAll("use"),n=[];if(s.forEach((function(t){var e=t.getAttributeNS("http://www.w3.org/1999/xlink","href");e&&e.startsWith("#Transformer3:")&&n.push(t)})),this.threeModel=n,this.threeModel.length){const t=this.threeModel[0].parentElement,e=t?t.parentElement:null;console.log("获取三色组件：",e);var r=e.cloneNode(!0);const s=r.querySelectorAll("use");s.forEach((t=>{t.setAttribute("y","50"),t.setAttribute("x","50"),t.setAttribute("style","pointer-events: bounding-box;"),t.setAttribute("transform","rotate(0,770,808) scale(1,1) translate(-50,-48)")})),this.sanseSvg=(new XMLSerializer).serializeToString(r);var i=document.getElementById("sanId"),o=this;i.addEventListener("click",(function(t){o.sanseColor=t.target.href.animVal}));const n=this.svgDoc.querySelectorAll("symbol"),l=[];n.forEach((function(t){t.id&&t.id.startsWith("Transformer3:")&&l.push(t)}))}}))},t.readAsText(e)}else alert("请选择一个有效的SVG文件")},repName(t){const e=t.replace(/^CD\./,"").replace(/\.fac\.svg$/,""),s=`${e.replace(/_/g,".")}.svg`;return s},copeSvg(){if(!this.newSvgContent)return void alert("请先导入svg文件");const t=new Blob([this.newSvgContent],{type:"image/svg+xml;charset=utf-8"}),e=URL.createObjectURL(t),s=document.createElement("a");s.href=e,s.download=this.Svgname,document.body.appendChild(s),s.click(),URL.revokeObjectURL(e),document.body.removeChild(s)}}}),l=o,c=s(1656),a=(0,c.A)(l,r,i,!1,null,null,null),h=a.exports;n.Ay.config.productionTip=!1,new n.Ay({render:t=>t(h)}).$mount("#app")}},e={};function s(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,s),i.exports}s.m=t,function(){var t=[];s.O=function(e,n,r,i){if(!n){var o=1/0;for(h=0;h<t.length;h++){n=t[h][0],r=t[h][1],i=t[h][2];for(var l=!0,c=0;c<n.length;c++)(!1&i||o>=i)&&Object.keys(s.O).every((function(t){return s.O[t](n[c])}))?n.splice(c--,1):(l=!1,i<o&&(o=i));if(l){t.splice(h--,1);var a=r();void 0!==a&&(e=a)}}return e}i=i||0;for(var h=t.length;h>0&&t[h-1][2]>i;h--)t[h]=t[h-1];t[h]=[n,r,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,i,o=n[0],l=n[1],c=n[2],a=0;if(o.some((function(e){return 0!==t[e]}))){for(r in l)s.o(l,r)&&(s.m[r]=l[r]);if(c)var h=c(s)}for(e&&e(n);a<o.length;a++)i=o[a],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(h)},n=self["webpackChunksvg"]=self["webpackChunksvg"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(6201)}));n=s.O(n)})();