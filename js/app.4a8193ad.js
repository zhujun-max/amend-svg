(function(){"use strict";var e={629:function(e,t,n){var s=n(6848),r=function(){var e=this,t=e._self._c;return t("div",[t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".svg"},on:{change:e.handleFileUpload}}),t("div",{staticClass:"topBUt"},[t("button",{on:{click:e.triggerFileUpload}},[e._v("导入SVG文件")]),t("button",{on:{click:function(t){return e.copeSvg()}}},[e._v("导出修改后的svg")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.Svgname,expression:"Svgname"}],staticStyle:{width:"20vw","margin-right":"4vw"},attrs:{type:"text",placeholder:"默认保存名"},domProps:{value:e.Svgname},on:{input:function(t){t.target.composing||(e.Svgname=t.target.value)}}}),t("button",{staticClass:"basicsXiu",on:{click:function(t){return e.basics()}}},[e._v("基础修改")]),e._l(e.colew,(function(n,s){return t("div",{key:s,staticClass:"div12",style:"background-color:"+n,on:{click:function(t){return e.cclier(n)}}},[e._v(" "+e._s(e.colorClass[n].slice(2,-2))+" ")])})),t("span",[e._v("线条颜色：")]),e._l(e.clomne,(function(n){return t("div",{key:n,staticClass:"div12",style:"background-color:"+n,on:{click:function(t){return e.cclier(n)}}})})),t("div",{staticStyle:{width:"20vh",height:"5vh"}},[t("svg",{staticStyle:{width:"100%",height:"100%"},attrs:{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",id:"sanIdsan"}},[t("g",{attrs:{id:"sanId"},domProps:{innerHTML:e._s(e.sanseSvg)}})])]),e._m(0)],2),t("div",{attrs:{id:"svg-dialog__body"}},[t("div",{ref:"svgContainer",staticClass:"boxpo",staticStyle:{position:"relative"},on:{mousedown:e.startSelection,mouseup:e.updateSelection}},[e.selecFrame.isSelecting?t("div",{staticClass:"selection-box",style:e.selecFrame.selectionStyle},[t("div",{staticClass:"topPO"},[e._v(" "+e._s(Math.trunc(e.selecFrame.selectionStyle.left.split("px")[0]))+"x"+e._s(Math.trunc(e.selecFrame.selectionStyle.top.split("px")[0]))+" ")]),t("div",{staticClass:"bottPO"},[e._v(" "+e._s(Math.trunc(+e.selecFrame.selectionStyle.left.split("px")[0]+ +e.selecFrame.selectionStyle.width.split("px")[0]))+"x"+e._s(Math.trunc(+e.selecFrame.selectionStyle.top.split("px")[0]+ +e.selecFrame.selectionStyle.height.split("px")[0]))+" ")])]):e._e(),e.svgContent?t("div",{attrs:{id:"svg-trigger"},domProps:{innerHTML:e._s(e.newSvgContent)}}):e._e()])])])},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"warn div12"},[t("span",[e._v("!")]),t("div",{staticClass:"poale"},[t("h3",[e._v("提示：")]),t("p",[e._v("可能引入svg的时候显示的内容与真实内容不一样，代码问题")]),t("p",[e._v("如果出现框选内容与修改内容不符，是svg的图层坐标轴对不上的原因，暂时无解")]),t("p",[e._v("三个圈或者两个圈的组件位置与svg中实际看到的不一样，暂时无解")]),t("p",[t("b",[e._v("注：导出的文件会默认删除所有a标签的跳转地址，会删除所有的image。会删除所有的组件颜色。")])]),t("h3",[e._v("操作方式")]),t("p",[e._v("1. 引入svg文件，先点击简易修改")]),t("p",[e._v("2. 鼠标在svg中框选需要修改的内容，然后点击左侧的颜色")]),t("p",[e._v("3. 需要修改单独的线条可以选择右侧的颜色。")]),t("p",[e._v("4. 右侧顶部的三个圈或者两个圈组件，选中圈，然后选中左侧的颜色，可以修改圈的颜色")]),t("p",[e._v("5. 修改文件名，导出svg")]),t("h3",[e._v("github：")]),t("p",[e._v("https://github.com/zhujun-max/amend-svg")])])])}],o=(n(4114),n(4603),n(7566),n(8721),{data(){return{svgContent:null,newSvgContent:null,Svgname:"",svgContentSrc:null,embedLoading:!1,SVGTitle:"",currentSvg:null,oldTargetNode:[],jumpSVGData:{},startX:0,startY:0,endX:0,endY:0,selectedLines:[],threeModel:[],colew:["rgb(240,65,85)","rgb(128,0,128)","rgb(255,255,0)","rgb(128,128,128)","rgb(0,0,139)","rgb(185,72,66)"],clomne:["rgb(0,0,255)","rgb(128,128,128)","rgb(0,255,255)"],newSelectedLines:[],newSelectedModel:[],selecFrame:{isSelecting:!1,selectionStyle:{position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",backgroundColor:"rgba(255, 0, 0, 0.3)",border:"1px solid red"}},colorClass:{"rgb(240,65,85)":"kv110kV","rgb(128,0,128)":"kv220kV","rgb(255,255,0)":"kv35kV","rgb(128,128,128)":"kv0kV","rgb(0,0,139)":"kv6kV","rgb(185,72,66)":"kv10kV"},svgDoc:"",sanseSvg:"",sanseColor:"",sanseSvgSan:""}},methods:{startSelection(e){this.startX=e.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.startY=e.clientY-this.$refs.svgContainer.getBoundingClientRect().top,console.log("按下坐标：",this.startX,this.startY),this.selecFrame.isSelecting=!0,window.addEventListener("mousemove",this.updateSelecmove)},updateSelecmove(e){this.endX=e.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.endY=e.clientY-this.$refs.svgContainer.getBoundingClientRect().top;const t=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),s=(Math.max(this.startX,this.endX),Math.max(this.startY,this.endY),Math.abs(this.endX-this.startX)),r=Math.abs(this.endY-this.startY);this.selecFrame.selectionStyle.left=t+"px",this.selecFrame.selectionStyle.top=n+"px",this.selecFrame.selectionStyle.width=s+"px",this.selecFrame.selectionStyle.height=r+"px"},updateSelection(e){const t=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),s=Math.max(this.startX,this.endX),r=Math.max(this.startY,this.endY);this.newSelectedLines=this.getIntersectingLines(t,n,s,r),this.newSelectedModel=this.getIntersectingmodel(t,n,s,r),console.log("选中的内容",this.newSelectedLines,this.newSelectedModel),window.removeEventListener("mousemove",this.updateSelecmove)},getIntersectingLines(e,t,n,s){console.log("选中的线条",e,t,n,s);const r=[],i=this.svgDoc.querySelectorAll("path");function o(r,i){return r>=e&&r<=n&&i>=t&&i<=s}function l(e){const t=e.match(/[ML]/g),n=e.match(/-?\d+(?:\.\d+)?/g).map(Number),s={};let r=0,i=0;for(let o=0;o<t.length;o++){const e=t[o];let l,a;"M"===e?((0===o||n[2*o-2]!==r&&n[2*o-1]!==i)&&(s["startX"]=n[2*o],s["startY"]=n[2*o+1]),r=n[2*o],i=n[2*o+1]):"L"===e&&(l=n[2*o]+("l"===e?r:0),a=n[2*o+1]+("l"===e?i:0),s["endX"]=l,s["endY"]=a,r=l,i=a)}return s}function a(e){const t=e.getAttribute("d"),n=l(t);return!(!o(n.startX,n.startY)&&!o(n.endX,n.endY))}for(const c of i)a(c)&&r.push(c);return r},getIntersectingmodel(e,t,n,s){const r=[],i=this.svgDoc.querySelectorAll("use");function o(r,i){return r>=e&&r<=n&&i>=t&&i<=s}function l(e){const t=e.getAttribute("x"),n=e.getAttribute("y"),s=t+e.getAttribute("width"),r=n+e.getAttribute("height");return!(!o(t,n)&&!o(s,r))}for(const a of i)l(a)&&r.push(a);return r},basics(){const e=["国网冀北秦皇岛集控站设备监视系统","变电站主页","光字牌索引图","二次网络结构","交直流系统","故障录波","事件列表","智能联动","在线监视","照明控制","动环监控","安全防卫","消防监视","区域用电负荷","实际有功总加"],t=this.svgDoc.querySelectorAll("#Text_Layer>text");e.forEach((e=>{t.forEach((t=>{e!==t.textContent.trim()||t.parentNode.removeChild(t)}))}));const n=this.svgDoc.querySelectorAll("#Other_Layer>image");n.forEach((e=>{e.parentNode.removeChild(e)}));const s=this.svgDoc.querySelectorAll("#Head_Layer>rect");s.forEach((function(e){e.setAttribute("fill","rgb(0,47,71)")}));const r=this.svgDoc.querySelectorAll("#Link_Layer>g>path");r.forEach((e=>{const t=e.getAttribute("d"),n=t.split(" ");n.length>=9&&(e.style["fill"]="none")}));const i=this.svgDoc.querySelectorAll("defs>symbol>*");i.forEach((e=>{e.setAttribute("stroke","")}));const o=this.svgDoc.querySelectorAll("a");o.forEach((e=>{e.removeAttribute("xlink:href")})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc)},cclier(e){if(this.sanseColor){this.threeModel.forEach((t=>{var n=t.getAttributeNS("http://www.w3.org/1999/xlink","href");n&&n.startsWith(this.sanseColor)&&t.setAttribute("class",this.colorClass[e])})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc);let t=document.getElementById("sanId");const n=t.querySelectorAll("use");n.forEach((t=>{var n=t.getAttributeNS("http://www.w3.org/1999/xlink","href");n&&n.startsWith(this.sanseColor)&&t.setAttribute("class",this.colorClass[e])})),this.sanseColor=""}else this.newSelectedLines.forEach((t=>{t.setAttribute("stroke",e)})),this.newSelectedModel.forEach((t=>{t.setAttribute("class",this.colorClass[e])})),this.selecFrame=this.$options.data().selecFrame,this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc),this.newSelectedLines=[],this.newSelectedModel=[]},triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(e){const t=e.target.files[0];if(t&&"image/svg+xml"===t.type){const e=new FileReader;this.Svgname=this.repName(t.name),e.onload=e=>{this.svgContent=e.target.result,this.newSvgContent=e.target.result,this.svgContentSrc=URL.createObjectURL(t),this.$nextTick((()=>{const e=new DOMParser;this.svgDoc=e.parseFromString(this.newSvgContent,"image/svg+xml"),this.sanseTop()}))},e.readAsText(t)}else alert("请选择一个有效的SVG文件")},repName(e){const t=e.replace(/^CD\./,"").replace(/\.fac\.svg$/,""),n=`${t.replace(/_/g,".")}.svg`;return n},copeSvg(){if(!this.newSvgContent)return void alert("请先导入svg文件");const e=new Blob([this.newSvgContent],{type:"image/svg+xml;charset=utf-8"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=this.Svgname,document.body.appendChild(n),n.click(),URL.revokeObjectURL(t),document.body.removeChild(n)},sanseTop(){const e=this.svgDoc.querySelector("#Transformer3_Layer");if(e){const n=e.querySelectorAll("use"),s=[],r=[];n.forEach((function(e){"0"==e["href"]?.animVal.slice(-1)&&(r.length&&r.includes(e["href"].animVal)||(s.push(e),r.push(e["href"].animVal)))}));var t=[];s.forEach(((e,n)=>{const s=e.parentElement,r=s?s.parentElement:null,i=r.cloneNode(!0);t.push(i);const o=i.querySelectorAll("use");o.forEach((e=>{e.setAttribute("y","50"),e.setAttribute("x",""+100*n),e.setAttribute("style","pointer-events: bounding-box;"),e.setAttribute("transform","rotate(0,770,808) scale(1,1) translate(-50,-48)")}))}))}const n=this.svgDoc.querySelector("#Transformer2_Layer");if(n){const e=n.querySelectorAll("use"),s=[],r=[];e.forEach((function(e){"0"==e["href"]?.animVal.slice(-1)&&(r.length&&r.includes(e["href"].animVal)||(s.push(e),r.push(e["href"].animVal)))})),s.forEach(((e,n)=>{const s=e.parentElement,r=s?s.parentElement:null,i=r.cloneNode(!0);t.push(i);const o=i.querySelectorAll("use");o.forEach((e=>{e.setAttribute("y","50"),e.setAttribute("x",""+80*(n+useArr.length)),e.setAttribute("style","pointer-events: bounding-box;"),e.setAttribute("transform","rotate(0,770,808) scale(1,1) translate(-50,-48)")}))}))}let s=document.createElementNS("http://www.w3.org/2000/svg","g");t.forEach((e=>{e instanceof Element&&"http://www.w3.org/2000/svg"===e.namespaceURI&&s.appendChild(e)}));let r=new XMLSerializer;this.sanseSvg=r.serializeToString(s);var i=document.getElementById("sanId"),o=this;i.addEventListener("click",(function(e){o.sanseColor=e.target.href.animVal}));const l=this.svgDoc.querySelectorAll("use"),a=[];l.forEach((function(e){var t=e.getAttributeNS("http://www.w3.org/1999/xlink","href");t&&t.startsWith("#Transformer")&&a.push(e)})),this.threeModel=a;const c=this.svgDoc.querySelector("defs"),h=c.cloneNode(!0);let u=h.querySelectorAll("symbol>*");u.forEach((e=>{e.setAttribute("stroke","")}));let g=document.getElementById("sanIdsan"),d=g.querySelector("defs");d||(d=document.createElementNS("http://www.w3.org/2000/svg","defs"),g.appendChild(d)),Array.from(h.children).forEach((function(e){d.appendChild(e.cloneNode(!0))}))}}}),l=o,a=n(1656),c=(0,a.A)(l,r,i,!1,null,null,null),h=c.exports;s.Ay.config.productionTip=!1,new s.Ay({render:e=>e(h)}).$mount("#app")}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,s,r,i){if(!s){var o=1/0;for(h=0;h<e.length;h++){s=e[h][0],r=e[h][1],i=e[h][2];for(var l=!0,a=0;a<s.length;a++)(!1&i||o>=i)&&Object.keys(n.O).every((function(e){return n.O[e](s[a])}))?s.splice(a--,1):(l=!1,i<o&&(o=i));if(l){e.splice(h--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var h=e.length;h>0&&e[h-1][2]>i;h--)e[h]=e[h-1];e[h]=[s,r,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,i,o=s[0],l=s[1],a=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(a)var h=a(n)}for(t&&t(s);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(h)},s=self["webpackChunksvg"]=self["webpackChunksvg"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(629)}));s=n.O(s)})();