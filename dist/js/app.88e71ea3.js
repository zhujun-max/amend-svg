(function(){"use strict";var t={1437:function(t,e,n){var i=n(6848),s=function(){var t=this,e=t._self._c;return e("div",[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".svg"},on:{change:t.handleFileUpload}}),e("div",{staticClass:"topBUt"},[e("button",{on:{click:t.triggerFileUpload}},[t._v("导入SVG文件")]),e("button",{on:{click:function(e){return t.copeSvg()}}},[t._v("导出修改后的svg")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Svgname,expression:"Svgname"}],staticStyle:{width:"20vw","margin-right":"4vw"},attrs:{type:"text",placeholder:"默认保存名"},domProps:{value:t.Svgname},on:{input:function(e){e.target.composing||(t.Svgname=e.target.value)}}}),e("button",{staticClass:"basicsXiu",on:{click:function(e){return t.basics()}}},[t._v("基础修改")]),t._l(t.colew,(function(n,i){return e("div",{key:i,staticClass:"div12",style:"background-color:"+n,on:{click:function(e){return t.cclier(n)}}},[t._v(" "+t._s(t.colorClass[n].slice(2,-2))+" ")])}))],2),e("div",{attrs:{id:"svg-dialog__body"}},[e("div",{ref:"svgContainer",staticClass:"boxpo",staticStyle:{position:"relative"},on:{mousedown:t.startSelection,mouseup:t.updateSelection}},[t.selecFrame.isSelecting?e("div",{staticClass:"selection-box",style:t.selecFrame.selectionStyle}):t._e(),t.svgContent?e("div",{attrs:{id:"svg-trigger"},domProps:{innerHTML:t._s(t.newSvgContent)}}):t._e()])])])},r=[],o=(n(4114),n(4603),n(7566),n(8721),{data(){return{svgContent:null,newSvgContent:null,Svgname:"",svgContentSrc:null,embedLoading:!1,SVGTitle:"",currentSvg:null,oldTargetNode:[],jumpSVGData:{},startX:0,startY:0,endX:0,endY:0,selectedLines:[],colew:["rgb(240,65,85)","rgb(128,0,128)","rgb(255,255,0)","rgb(128,128,128)","rgb(0,0,139)","rgb(185,72,66)"],newSelectedLines:[],newSelectedModel:[],selecFrame:{isSelecting:!1,selectionStyle:{position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",backgroundColor:"rgba(255, 0, 0, 0.3)",border:"1px solid red"}},colorClass:{"rgb(240,65,85)":"kv110kV","rgb(128,0,128)":"kv220kV","rgb(255,255,0)":"kv35kV","rgb(128,128,128)":"kv0kV","rgb(0,0,139)":"kv6kV","rgb(185,72,66)":"kv10kV"},svgDoc:""}},methods:{startSelection(t){this.startX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.startY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top,console.log("按下坐标：",this.startX,this.startY),this.selecFrame.isSelecting=!0,window.addEventListener("mousemove",this.updateSelecmove)},updateSelecmove(t){console.log("拖拽",t.clientX-this.$refs.svgContainer.getBoundingClientRect().left),this.endX=t.clientX-this.$refs.svgContainer.getBoundingClientRect().left,this.endY=t.clientY-this.$refs.svgContainer.getBoundingClientRect().top,console.log("弹起坐标：",this.endX,this.endY);const e=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),i=Math.max(this.startX,this.endX),s=Math.max(this.startY,this.endY),r=Math.abs(this.endX-this.startX),o=Math.abs(this.endY-this.startY);console.log("选中的坐标：",e,n,i,s),this.selecFrame.selectionStyle.left=e+"px",this.selecFrame.selectionStyle.top=n+"px",this.selecFrame.selectionStyle.width=r+"px",this.selecFrame.selectionStyle.height=o+"px"},updateSelection(t){const e=Math.min(this.startX,this.endX),n=Math.min(this.startY,this.endY),i=Math.max(this.startX,this.endX),s=Math.max(this.startY,this.endY);this.newSelectedLines=this.getIntersectingLines(e,n,i,s),this.newSelectedModel=this.getIntersectingmodel(e,n,i,s),window.removeEventListener("mousemove",this.updateSelecmove),this.selecFrame.isSelecting},getIntersectingLines(t,e,n,i){const s=[],r=this.svgDoc.querySelectorAll("path");function o(s,r){return s>=t&&s<=n&&r>=e&&r<=i}function l(t){const e=t.match(/[ML]/g),n=t.match(/-?\d+(?:\.\d+)?/g).map(Number),i={};let s=0,r=0;for(let o=0;o<e.length;o++){const t=e[o];let l,c;"M"===t?((0===o||n[2*o-2]!==s&&n[2*o-1]!==r)&&(i["startX"]=n[2*o],i["startY"]=n[2*o+1]),s=n[2*o],r=n[2*o+1]):"L"===t&&(l=n[2*o]+("l"===t?s:0),c=n[2*o+1]+("l"===t?r:0),i["endX"]=l,i["endY"]=c,s=l,r=c)}return i}function c(t){const e=t.getAttribute("d"),n=l(e);return!(!o(n.startX,n.startY)&&!o(n.nextX,n.nextY))}for(const a of r)c(a)&&s.push(a);return s},getIntersectingmodel(t,e,n,i){const s=[],r=this.svgDoc.querySelectorAll("use");function o(s,r){return s>=t&&s<=n&&r>=e&&r<=i}function l(t){const e=t.getAttribute("x"),n=t.getAttribute("y"),i=e+t.getAttribute("width"),s=n+t.getAttribute("height");return!(!o(e,n)&&!o(i,s))}for(const c of r)l(c)&&s.push(c);return s},cclier(t){this.newSelectedLines.forEach((e=>{e.setAttribute("stroke",t)})),this.newSelectedModel.forEach((e=>{e.setAttribute("class",this.colorClass[t])})),this.selecFrame=this.$options.data().selecFrame,this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc),this.newSelectedLines=[],this.newSelectedModel=[]},basics(){const t=["国网冀北秦皇岛集控站设备监视系统","变电站主页","光字牌索引图","二次网络结构","交直流系统","故障录波","事件列表","智能联动","在线监视","照明控制","动环监控","安全防卫","消防监视","区域用电负荷","实际有功总加"],e=this.svgDoc.querySelectorAll("#Text_Layer>text");t.forEach((t=>{e.forEach((e=>{t!==e.textContent.trim()||e.parentNode.removeChild(e)}))}));const n=this.svgDoc.querySelectorAll("#Other_Layer>image");n.forEach((t=>{t.parentNode.removeChild(t)}));const i=this.svgDoc.querySelectorAll("#Head_Layer>rect");i.forEach((function(t){t.setAttribute("fill","rgb(0,47,71)")}));const s=this.svgDoc.querySelectorAll("#Link_Layer>g>path");s.forEach((t=>{const e=t.getAttribute("d"),n=e.split(" ");n.length>=9&&(t.style["fill"]="none")}));const r=this.svgDoc.querySelectorAll("defs>symbol>*");r.forEach((t=>{t.setAttribute("stroke","")})),this.newSvgContent=(new XMLSerializer).serializeToString(this.svgDoc)},triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(t){const e=t.target.files[0];if(e&&"image/svg+xml"===e.type){const t=new FileReader;this.Svgname=this.repName(e.name),t.onload=t=>{this.svgContent=t.target.result,this.newSvgContent=t.target.result,this.svgContentSrc=URL.createObjectURL(e),this.$nextTick((()=>{const t=new DOMParser;this.svgDoc=t.parseFromString(this.newSvgContent,"image/svg+xml");const e=this.svgDoc.querySelectorAll("a");e.forEach((t=>{t.removeAttribute("xlink:href")}))}))},t.readAsText(e)}else alert("请选择一个有效的SVG文件")},repName(t){const e=t.replace(/^CD\./,"").replace(/\.fac\.svg$/,""),n=`${e.replace(/_/g,".")}.svg`;return n},copeSvg(){const t=new Blob([this.newSvgContent],{type:"image/svg+xml;charset=utf-8"}),e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=this.repName(this.Svgname),document.body.appendChild(n),n.click(),URL.revokeObjectURL(e),document.body.removeChild(n)}}}),l=o,c=n(1656),a=(0,c.A)(l,s,r,!1,null,null,null),u=a.exports;i.Ay.config.productionTip=!1,new i.Ay({render:t=>t(u)}).$mount("#app")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,i,s,r){if(!i){var o=1/0;for(u=0;u<t.length;u++){i=t[u][0],s=t[u][1],r=t[u][2];for(var l=!0,c=0;c<i.length;c++)(!1&r||o>=r)&&Object.keys(n.O).every((function(t){return n.O[t](i[c])}))?i.splice(c--,1):(l=!1,r<o&&(o=r));if(l){t.splice(u--,1);var a=s();void 0!==a&&(e=a)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[i,s,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,r,o=i[0],l=i[1],c=i[2],a=0;if(o.some((function(e){return 0!==t[e]}))){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(c)var u=c(n)}for(e&&e(i);a<o.length;a++)r=o[a],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(u)},i=self["webpackChunksvg"]=self["webpackChunksvg"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],(function(){return n(1437)}));i=n.O(i)})();